<!DOCTYPE html>
{% load static %}
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">

        {% block title %}
        <title>Rezepte</title>
        {% endblock %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
        <link rel="stylesheet" href="{% static 'recipes/style.css' %}">
        <link href="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/css/tom-select.bootstrap5.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css">
    </head>

    <body>
        <nav class="navbar navbar-light bg-light sticky-top shadow-sm">
            <div class="container-fluid">
                <!-- Linke Links -->
                <div class="navbar-nav d-flex flex-row gap-3">
                    <a class="nav-link {% if request.resolver_match.url_name == 'index' %}active{% endif %}" 
                    href="{% url 'recipes:index' %}{% if request.GET %}?{{ request.GET.urlencode }}{% endif %}">
                        Rezepte
                    </a>

                    <a class="nav-link {% if request.resolver_match.url_name == 'weekly_plan' %}active{% endif %}" 
                    href="{% url 'recipes:weekly_plan' %}{% if request.GET %}?{{ request.GET.urlencode }}{% endif %}">
                        Wochenplan
                    </a>
                </div>

                <!-- Rechte Links: Login / Username / Logout -->
                <div class="d-flex align-items-center gap-3 ms-auto">
                    {% if user.is_authenticated %}
                        <span class="navbar-text">
                            ðŸ‘‹ {{ user.username }}
                        </span>
                        <form method="post" action="{% url 'logout' %}" class="d-inline m-0 p-0">
                            {% csrf_token %}
                            <button type="submit" class="nav-link p-0 m-0 align-middle">Logout</button>
                        </form>
                    {% else %}
                        <a class="nav-link" href="{% url 'login' %}">Login</a>
                    {% endif %}
                </div>
            </div>
        </nav>

        
        {% block content %}{% endblock %}
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
        <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/de.js"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                document.querySelectorAll(".calendar-form").forEach(form => {
                    const input = form.querySelector(".flatpickr-input");
                    const button = form.querySelector(".calendar-btn");

                    const fp = flatpickr(input, {
                        dateFormat: "Y-m-d",
                        defaultDate: "today",
                        disableMobile: true,
                        locale: "de", // â† Deutsch + Wochenstart Montag

                        onChange() {
                            form.submit();
                        }
                    });

                    button.addEventListener("click", () => fp.open());
                });
            });
        </script>


    </body>
</html>